<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <script src="http://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script>
    <title>微信接口测试页面</title>
</head>
	微信接口测试页面<br/><br/>
	<input onclick="testPicUpload()" type="button" value="单个图片上传微信服务器，返回微信服务器地址" /><br/><br/>
	
	<input onclick="testGetArticles()" type="button" value="分页获取所有图文信息(含关键词搜索)" /><br/><br/>
	
	<input onclick="testInsertArticle()" type="button" value="新增图文信息" /><br/><br/>
	
	<input onclick="testDelArticle()" type="button" value="删除图文信息" /><br/><br/>
	
	<input onclick="testGetOneArticle()" type="button" value="获取单个图文信息" /><br/><br/>

	<input onclick="testUpdateArticle()" type="button" value="修改图文信息" /><br/><br/>
	
	<input onclick="testSyncNews()" type="button" value="微信图文素材同步" /><br/><br/>

<body>
    <script type="text/javascript">
    	//单个图片上传微信服务器，返回微信服务器地址
    	function testPicUpload(){
    			var param = {
    		    	    "img": "http://statics.xiumi.us/stc/images/templates-assets/tpl-paper/image/2016-12-13-1.jpeg"
    		    	     };
    			console.log(JSON.stringify(param));
    			$.post("${req.contextPath}/wx/artmtl/getWxUrl",param,function(data){
    				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
    				console.log(JSON.stringify(data));
    				console.log(data);
    			},"json");
    	}
    	
    	
    	//分页获取所有图文信息
    	function testGetArticles(){
    			var param = {
    		    	"pageNumber": "1",	//页码(必需)
    		    	"limit": "10",		//每页显示数量(必需)
    		    	"keyword":""		//标题|作者|摘要(需)
    		   	};
    			console.log(JSON.stringify(param));
    			$.post("${req.contextPath}/wx/artmtl/getList",param,function(data){
    				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
    				console.log(JSON.stringify(data));
    				console.log(data);
    			},"json");
    	}
    
    	
    	//新增图文信息
    	function testInsertArticle(){
    			var param = {
    					  "articles": [
    					    {
    					       "title": "helei-helei-1-测试的微信图文消息01170946",			//标题(必需)
    					       "thumbMediaId": "LztR02EaS2zSL_-8Q8VzKc-3kaRujSEHDYlXIJBCipQ",	//图文消息的封面图片素材id（必须是永久mediaID）(必需)
    					       "author": "helei",	//作者(必需)
    					       "digest": "测试图文",	//图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空(必需)
    					       "showCoverPic": "1",		//是否显示封面，0为false，即不显示，1为true，即显示(必需)
    					       "content": "测试的微信图文消息",	//图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS(必需)
    					       "sourceUrl": "www.taobao.com",	//图文消息的原文地址，即点击“阅读原文”后的URL(必需)，如果没有阅读原文，传空字符串"".
    					       "type": "activity",	//类型(article:文章|activity:优惠活动) ，目前暂时支持这两种类型
    					       "belongCity": "666",	//活动隶属的城市
    					       "actStartDate": "2017-02-08 15:00:00",	//活动开始日期
    					       "actEndDate": "2017-03-08 15:00:00",	//活动结束日期
    					    },
    					    {
     					       "title": "helei-helei-2-测试的微信图文消息01170946",			//标题
     					       "thumbMediaId": "LztR02EaS2zSL_-8Q8VzKc-3kaRujSEHDYlXIJBCipQ",	//图文消息的封面图片素材id（必须是永久mediaID）
     					       "author": "helei",	//作者
     					       "digest": "测试图文",	//图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空
     					       "showCoverPic": "1",		//是否显示封面，0为false，即不显示，1为true，即显示
     					       "content": "测试的微信图文消息",	//图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS
     					       "sourceUrl": "www.taobao.com",	//图文消息的原文地址，即点击“阅读原文”后的URL(必需)，如果没有阅读原文，传空字符串"".
	   					       "type": "activity",	//类型(article:文章|activity:优惠活动) ，目前暂时支持这两种类型
	   					       "belongCity": "666",	//活动隶属的城市
	   					       "actStartDate": "2017-02-08 15:00:00",	//活动开始日期
	   					       "actEndDate": "2017-03-08 15:00:00",	//活动结束日期 
    					   },
     					   {
     					       "title": "helei-3-测试的微信图文消息01170942",			//标题
     					       "thumbMediaId": "LztR02EaS2zSL_-8Q8VzKc-3kaRujSEHDYlXIJBCipQ",	//图文消息的封面图片素材id（必须是永久mediaID）
     					       "author": "helei",	//作者
     					       "digest": "测试图文",	//图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空
     					       "showCoverPic": "1",		//是否显示封面，0为false，即不显示，1为true，即显示
     					       "content": "测试的微信图文消息",	//图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS
     					       "sourceUrl": "www.taobao.com",	//图文消息的原文地址，即点击“阅读原文”后的URL(必需)，如果没有阅读原文，传空字符串"".
   					       	   "type": "activity",	//类型(article:文章|activity:优惠活动) ，目前暂时支持这两种类型
   					           "belongCity": "666",	//活动隶属的城市
   					           "actStartDate": "2017-02-08 15:00:00",	//活动开始日期
   					           "actEndDate": "2017-03-08 15:00:00",	//活动结束日期
     					    }
    					 ]
    					};
    			console.log(JSON.stringify(param));
    			$.post("${req.contextPath}/wx/artmtl/insertWXMaterial",param,function(data){
    				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
    				console.log(JSON.stringify(data));
    				console.log(data);
    			},"json");
    	}
    
    	
    	//删除图文消息
    	function testDelArticle(){
    		var param = {
					  "materialId": "c255bd99ec9446cebd657e99dd809e68",		//图文素材ID(必需)
					  "mediaId": "LztR02EaS2zSL_-8Q8VzKYYhvm0JHp56Yn0Ob-kgDZE"			//微信媒体ID(必需)
					};
			console.log(JSON.stringify(param));
			$.post("${req.contextPath}/wx/artmtl/deleteWXMaterial",param,function(data){
				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
				console.log(JSON.stringify(data));
				console.log(data);
			},"json");
    	}
    	
    	
    	//获取单个图文消息
    	function testGetOneArticle(){
    		var param = {
					  "materialId": "af9ffd0c376741b599ff306563b97174"	//图文素材ID(必需)
					};
			console.log(JSON.stringify(param));
			$.post("${req.contextPath}/wx/artmtl/getById",param,function(data){
				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
				console.log(JSON.stringify(data));
				console.log(data);
			},"json");
    	}
    	
    	
    	
    	//修改图文信息
    	function testUpdateArticle(){
    			var param = [];
    			//第一个要修改的文章
    			var subparam = {
						  "mediaId":"LztR02EaS2zSL_-8Q8VzKXdPUuQIIw4CqurwUyS5yys",		//要修改的图文素材mediaId(必需)
						  "index":"0",			//要更新的文章在图文消息中的位置（多图文消息时，此字段才有意义），第一篇为0(必需)
						  "article": {
							   "articleId":"78fae063b37b4ebfb256f6137aa3c45a",
						       "title": "修改的文章-666-01171110",		//标题(必需)
						       "thumbMediaId": "LztR02EaS2zSL_-8Q8VzKdPqnA5XgIjCnqpa9hkBeoM",	//图文消息的封面图片素材id（必须是永久mediaID）(必需)
						       "author": "修改的-01171110",		//作者(必需)
						       "digest": "修改的-01171110",		//图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空(必需)
						       "showCoverPic": "1",	//是否显示封面，0为false，即不显示，1为true，即显示(必需)
						       "content": "修改的-01171110",		//图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS(必需)
						       "sourceUrl": "修改的-01171110",		//图文消息的原文地址，即点击“阅读原文”后的URL(必需)
						  	   "type": "activity",	//类型(article:文章|activity:优惠活动) ，目前暂时支持这两种类型
   					           "belongCity": "898989898989",	//活动隶属的城市
   					           "actStartDate": "2017-08-08 15:00:00",	//活动开始日期
   					           "actEndDate": "2017-09-09 15:00:00",	//活动结束日期  
						  }
						};
    			//第二个要修改的文章
    			var subparam2 = {
						  "mediaId":"LztR02EaS2zSL_-8Q8VzKXdPUuQIIw4CqurwUyS5yys",		//要修改的图文素材mediaId
						  "index":"0",			//要更新的文章在图文消息中的位置（多图文消息时，此字段才有意义），第一篇为0
						  "article": {
							   "articleId":"4ae0c7b9ea2b47559ced2fe477811026",
						       "title": "艰难的修改文章-666-01171110",		//标题
						       "thumbMediaId": "LztR02EaS2zSL_-8Q8VzKdPqnA5XgIjCnqpa9hkBeoM",	//图文消息的封面图片素材id（必须是永久mediaID）
						       "author": "艰难的修改文章-01171110",		//作者
						       "digest": "艰难的修改文章-01171110",		//图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空
						       "showCoverPic": "1",	//是否显示封面，0为false，即不显示，1为true，即显示
						       "content": "艰难的修改文章-01171110",		//图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS
						       "sourceUrl": "艰难的修改文章-01171110"		//图文消息的原文地址，即点击“阅读原文”后的URL
						    }
						};
    			param.push(subparam);
    			//param.push(subparam2);
    			console.log(JSON.stringify(param));
    			//contentType:"application/json"参数很重要
    			$.ajax({ 
    		        type:"POST", 
    		        url:"${req.contextPath}/wx/artmtl/updateWXMaterial", 
    		        dataType:"json",      
    		        contentType:"application/json",               
    		        data:JSON.stringify(param), 
    		        success:function(data){
    		        	alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
        				console.log(JSON.stringify(data));
        				console.log(data);                        
    		        } 
    		     });
    	}
    	
    	
    	//微信图文素材同步
    	function testSyncNews(){
    		var param = {	//无参数
			};
			console.log(JSON.stringify(param));
			$.post("${req.contextPath}/wx/artmtl/syncNews",param,function(data){
				alert(JSON.stringify("code="+data.returnCode+"***message="+data.returnMessage));
				console.log(JSON.stringify(data));
				console.log(data);
			},"json");
    		
    	}
    	
   
    </script>
</body>

</html>
